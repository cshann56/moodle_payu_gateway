define("paygw_payuindia/pay",["exports","jquery","core/ajax","core/notification","core/modal_factory","core/modal_events"],(function(_exports,_jquery,_ajax,_notification,_modal_factory,_modal_events){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}
/**
   * This is an empty module, that is required before all other modules.
   * Because every module is returned from a request for any other module, this
   * forces the loading of all modules with a single request.
   *
   * @module     paygw_payuindia/payusubmit
   * @package
   * @copyright  2022 Christopher Shannon <cshannon108@gmail.com>
   * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later
   * @since      3.11
   */Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_jquery=_interopRequireDefault(_jquery),_ajax=_interopRequireDefault(_ajax),_notification=_interopRequireDefault(_notification),_modal_factory=_interopRequireDefault(_modal_factory),_modal_events=_interopRequireDefault(_modal_events);_exports.init=function(){function sendFormDataToRemote(){(0,_jquery.default)("#payuworkform input[type='text']").prop("disabled",!0),(0,_jquery.default)("#payuworkform select").prop("disabled",!0),(0,_jquery.default)("#payusubmitbutton").prop("disabled",!0),(0,_jquery.default)("#payucancelbutton").prop("disabled",!0);var fieldvals={};(0,_jquery.default)("#payuworkform input,select").filter("[name='component'],[name='paymentarea'],[name='itemid'],[name='productinfo'],[name='amount'],[name='additional_charges'],[name='email'],[name='phone'],[name='firstname'],[name='lastname'],[name='address1'],[name='address2'],[name='city'],[name='state'],[name='country'],[name='zipcode'],[name='udf1']").each((function(index,elem){fieldvals[elem.name]=elem.value})),_ajax.default.call([{methodname:"paygw_payuindia_get_hash",args:{inputparams:[{component:fieldvals.component,paymentarea:fieldvals.paymentarea,itemid:fieldvals.itemid,productinfo:fieldvals.productinfo,amount:fieldvals.amount,additional_charges:fieldvals.additional_charges,email:fieldvals.email,phone:fieldvals.phone,firstname:fieldvals.firstname,lastname:fieldvals.lastname,address1:fieldvals.address1,address2:fieldvals.address2,city:fieldvals.city,state:fieldvals.state,country:fieldvals.country,zipcode:fieldvals.zipcode,udf1:fieldvals.udf1}]}}])[0].done((function(response){response=response[0],(0,_jquery.default)("#payuworkform input[name='txnid']").val(response.txnid),(0,_jquery.default)("#payuworkform input[name='key']").val(response.key),(0,_jquery.default)("#payuworkform input[name='hash']").val(response.hash),(0,_jquery.default)("#payusendform input,select").each((function(index,sendelem){var workelem=(0,_jquery.default)("#payuworkform input,select").filter("[name='"+sendelem.name+"']")[0];sendelem.value=workelem.value})),document.getElementById("payusendform").submit()})).fail((function(ex){(0,_jquery.default)("#payuworkform input[type='text']").prop("disabled",!1),(0,_jquery.default)("#payuworkform select").prop("disabled",!1),(0,_jquery.default)("#payusubmitbutton").prop("disabled",!1),(0,_jquery.default)("#payucancelbutton").prop("disabled",!1),_notification.default.exception(ex)}))}function cancelTransaction(){var courseId=(0,_jquery.default)("#payuworkform input[name='courseid']").val(),redirectUrl=(0,_jquery.default)("#payuworkform input[name='wwwroot']").val()+"/enrol/index.php?id="+courseId;window.location.replace(redirectUrl)}document.getElementById("payusubmitbutton").onclick=function(){var retval,curFocusedElem;retval=!1,curFocusedElem=(0,_jquery.default)(":focus")[0],(0,_jquery.default)("#payuworkform input").filter("[name='email'],[name='phone'],[name='firstname'],[name='lastname'],[name='address1'],[name='address2'],[name='city'],[name='state'],[name='country'],[name='zipcode']").each((function(index,elem){elem.focus(),elem.blur()})),curFocusedElem.focus(),0==(0,_jquery.default)("#payuworkform input[aria-invalid='true']").length&&(retval=!0),retval&&_modal_factory.default.create({type:_modal_factory.default.types.SAVE_CANCEL,title:"Submit Payment",body:"Pressing OK will redirect your browser to another website that will process your payment. After the transaction is complete, your browser will be redirected back to this website. Do you want to continue?"}).then((function(modal){modal.setSaveButtonText("OK"),modal.getRoot().on(_modal_events.default.save,sendFormDataToRemote),modal.show()}))},document.getElementById("payucancelbutton").onclick=function(){_modal_factory.default.create({type:_modal_factory.default.types.SAVE_CANCEL,title:"Cancel Payment",body:"Pressing OK will leave this page, and all form data will be lost. Do you want to continue?"}).then((function(modal){modal.setSaveButtonText("OK"),modal.getRoot().on(_modal_events.default.save,cancelTransaction),modal.show()}))};var myCountriesSelect=(0,_jquery.default)('#payuworkform select[name="country"]');myCountriesSelect[0].onclick=function(){var curCountry=myCountriesSelect.val();_ajax.default.call([{methodname:"paygw_payuindia_get_stateregioninfo",args:{country:curCountry}}])[0].done((function(response){var staterecs=response.records.split("|"),stateField=(0,_jquery.default)("#payuworkform select[name='state']");stateField.empty();for(var sfDomObj=stateField[0],i=0;i<staterecs.length;i++){var rec=staterecs[i].split(";"),opt=document.createElement("option");opt.value=rec[0],opt.text=rec[1],sfDomObj.add(opt)}})).fail((function(ex){_notification.default.exception(ex)}))}}}));

//# sourceMappingURL=pay.min.js.map